# network

## HTTP基础

Hypertext Transfer Protocol  
超文本传输协议  

浏览器解对URL进行解析，生成发送给web服务器的请求消息  
http:代表访问数据源的机制，协议；还有ftp:、mail:、news:、file:多种方式  
// 后面的字符是服务器域名，如`www.baidu.com`  
/目录名/.../文件名，表示数据源文件的路径名  
`http://www.kimalan.com/dir/`这个URL以`/dir/`结尾，文件名被省略，服务器事先设置好了文件名省略时访问的默认文件名，如index.html或default.html  
`http://www.kimalan.com/`以表示根目录的/结尾
`http://www.kimalan.com`没有路径，默认问根目录/事先设置的默认文件  
`http://www.kimalan.com/whatisthis`如果根目录存在whatisthis文件，就按文件名处理，存在whatisthis目录，就按目录名处理（同一级路径下无法创建两个同名的文件和目录，并不会产生歧义）  

### 请求和响应

HTTP协议定义了客户端和服务器之间交互的消息内容和步骤  
请求消息包括两部分内容，对什么，进行怎样的操作  
对什么这部分称为URI，一个存放网页数据的文件名或一个CGI程序的文件名，如/dir/file/html或/dir/program.cgi，访问的目标  
进行怎样的操作部分成为方法，方法表示需要让web服务器完成怎样的工作，例如读取URI表示的数据；将客户端输入的数据发送给URI表示的程序等  
GET方法，获取URI指定的信息  
POST方法，从客户的向服务器发送数据，一般用于发送表单中填写的数据等情况下  
GET和POST是最常用的方法，其他方法很少见  
PUT方法，替换URI指定的服务器上的文件，如URI指定的文件不存在则创建新文件  
DELETE方法，删除URI指定的服务器上的文件  

web服务器在收到请求消息之后，对其进行解析，根据请求中的要求完成工作，将结果存放在响应信息中  
响应信息开头有个状态码，表示操作的执行结果是成功还是错误  
200 表示成功  
404 表示找不到文件  

客户端收到响应信息之后，浏览器读取其中的信息，显示在屏幕上  

### 请求消息

请求消息第一行是请求行，以方法开头  
`<方法><空格><URI><空格><HTTP版本>`  

第二回开始是消息头，请求行表示请求的大概内容，消息头包含一些额外的详细信息  

消息头之后添加一个空行，然后写上需要发送的数据，这就是消息体message body  

一条请求消息中只能写一个URI，只能获取一个对象  
如果要获取多个对象，就要对每个对象发送一条请求消息  

web服务器并不在意多个请求之间的关系，是否同一个网页，他的任务只是对每一条单独的请求返回一条响应而已  

### 响应消息

响应消息的格式和请求消息相同，差别只在第一行  
响应消息中第一行叫状态行，内容为状态码和响应短语，表示请求执行结果是成功还是错误  
`<HTTP版本><空格><状态码><空格><响应短语>`

### 状态码

状态码是三位的数字，第一位数字表示状态类型，第二三位数字表示具体的情况  

状态码 | 含义
:-:|:-:
1xx | 告知请求的处理进度和情况
2xx | 成功
3xx | 表示需要进一步操作
4xx | 客户端错误
5xx | 服务器错误

### 头字段

消息头 | 含义
:-:|:-:
通用头 | 适用于请求信息和响应信息
Date | 表示请求和响应生成的日期
Pragma | 表示数据是否允许缓存的通信选项
Cache-Control | 控制缓存的相关信息
Connection | 设置发送响应之后TCP连接是否继续保持的通信选项
请求头 | 用于请求消息
Authorization | 身份认证数据
From | 请求发送者的邮件地址
If-Modified-Since | 如果希望仅当某个日期之后有更新时执行请求，可以在这个字段指定希望的日期。一般来说，这个功能的用途在于判断客户端缓存的数据是否已经过期，如果已过期则获取新的数据
Referer | 当通过点击超链接进入下一个页面时，在这里会记录下上一个页面的URI
User-Agent | 客户端软件的名称和版本号等相关信息
Accept | 客户端可支持的数据类型（Content-Type），以MIME类型来表示
Accept-Charset | 客户端可支持的字符集
Accept-Encoding | 客户端可支持的编码格式（Content—Encoding），一般来说表示数据的压缩格式
Host | 接收请求的服务器IP和端口号
If-Match | 参见Etag
If-None-Match | 参见Etag
If-Unmodified-Since | 当指定日期之后数据未更新时执行请求
Range | 当需要只获取部分数据而不是全部数据时，可通过这个字段指定要获取的数据范围
响应头 | 适用于响应信息
Location | 表示信息的准确位置，当请求的URI为相对路径是，这个字段用来返回绝对路径
Server | 服务器程序的名称和版本号等相关信息
WWW-Authenticate | 当请求的信息存在访问控制时，返回身份认证用的数据（Challenge）
Accept-Ranges | 当希望仅请求部分数据（使用Range来指定范围）时，服务器会告知客户端是否支持这一功能
实体头 | 用于消息体
Allow | 表示指定的URI支持的方法
Content-Encoding | 当消息体经过压缩等编码处理时，表示其编码格式
Content-Length | 表示消息体的长度
Content-Type | 表示消息体的数据类型，以MIME规格定义的数据类型来表示
Expires | 表示消息体的有效期
Last-Modified | 数据的最后更新时间
Content-Language | 消息体的语言，zh汉语，en英语
Content-Location | 消息体在服务器上的位置（URI）
Content-Range | 当仅请求部分数据时，表示消息体包含的数据范围
Etag | 在更新操作中，有时候需要基于上一次请求的响应数据来发送下一次请求。在这种情况下，这个字段可以用来提供上次响应与下次请求之间的关联信息。上次响应中，服务器会通过Etag向客户端发送一个唯一标识，在下次请求中客户端可以通过If-Match、If-None-Match、If-Range字段将这个标识告知服务器。这样服务器就知道该请求和上次的响应是相关的。这个字段的功能和Cookie是相同的，但Cookie是网景公司自行开发的规格，而Etag是将其进行标准化后的规格
