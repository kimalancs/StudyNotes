# dns

## 基础

域名解析系统  
domain name system  

浏览器访问的url中使用域名，方便记忆  
服务器采用IP地址来提供服务，运行效率  

## dns查询流程

查询`www.baidu.com`域名对应的IP地址

1. 客户端访问最近的一台dns服务器（客户端TCP/IP设置的dns服务器），找到根域dns服务器的IP  
2. 从顶层向下查找  
    * 最近的dns服务器向根域服务器发送查询消息，根域服务器返回其管理的com域的dns服务器的IP
    * 最近的dns服务器向com域服务器发送查询消息，com域服务器返回其管理的baidu域dns服务器的IP
    * 最近的dns服务器向baidu域服务器发送查询消息，baidu域服务器返回其管理的www这个web服务器的IP地址
3. 最近的dns服务器获取到www这个web服务器的IP地址，返回给客户端，客户端访问该IP地址。

现实中，一台dns服务器可以管理多个域的信息，并不一定每个域都有单独的服务器，上级域和下级域可能共享一台服务器，访问上级域dns服务器时，就可以直接跳过下级域，直接返回再下一级域的dns服务器IP地址。  
并不一定从最上级的根域开始查，当最近的dns服务器缓存中存在该域名或该域名的某一级域的信息，可以直接返回，或从某一级域开始向下查询（缓存不一定正确，有可能缓存后原信息发生了变更，所以dns服务器中缓存的信息都要设定有效期，超期就删除）  
